:root{
  /* Color system */
  --bg: #fff7fa;
  --card: #ffffff;
  --accent: #ff7fbf;
  --accent-2: #ff9ac0;
  --muted: #f8e7ef;
  --text: #4a2b3a;
  --soft: #f6d7e6;

  /* Elevation */
  --shadow-sm: 0 6px 20px rgba(78,24,48,0.06);
  --shadow-lg: 0 18px 50px rgba(80,20,40,0.08);

  /* Motion */
  --ease-soft: cubic-bezier(.22,.9,.29,1);
  --micro: 220ms;
  --mid: 480ms;
  --long: 650ms;
}

*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0;
  font-family: 'Inter', system-ui, -apple-system, 'Segoe UI', Roboto, sans-serif;
  background: linear-gradient(180deg, var(--bg) 0%, #fffefe 100%);
  color:var(--text);
  -webkit-font-smoothing:antialiased;
  -moz-osx-font-smoothing:grayscale;
}

.stage{min-height:100vh;display:flex;align-items:center;justify-content:center;padding:28px}
.stage.gift-open{align-items:flex-start;padding-top:20px}
.stage.gift-open .primary-stage{align-items:flex-start;padding:0 28px 80px}

/* Primary centered stage that does not move during content swaps */
.primary-stage{display:flex;align-items:center;justify-content:center;width:100%;max-width:820px;min-height:auto;padding:28px 28px 80px}
.stage-content{width:100%;display:flex;flex-direction:column;align-items:center;justify-content:center;gap:24px}
.landing, .response-content{display:flex;flex-direction:column;align-items:center;gap:20px;text-align:center;max-width:920px;width:100%}

.gif-placeholder{width:140px;height:140px;border-radius:18px;display:flex;align-items:center;justify-content:center;background:linear-gradient(135deg,var(--muted),#fff);box-shadow:var(--shadow-sm);will-change:transform,opacity}
.gif-placeholder.large{width:240px;height:240px}
.heart-svg{width:74%;height:74%;filter:drop-shadow(0 10px 30px rgba(255,127,191,0.14))}

.question{font-family: 'Playfair Display', serif;font-size:40px;line-height:1.02;margin:6px 0;color:var(--text);font-weight:600;letter-spacing:0.2px}
.question.small{font-size:28px}

.buttons{display:flex;gap:16px;position:relative;margin-top:6px}
.btn{--s:1;--tx:0px;--ty:0px;display:inline-flex;align-items:center;justify-content:center;padding:12px 28px;border-radius:999px;border:none;font-weight:600;cursor:pointer;box-shadow:var(--shadow-sm);background:var(--card);transition:transform var(--micro) var(--ease-soft), box-shadow var(--micro) var(--ease-soft), opacity var(--micro);transform:translate(var(--tx), var(--ty)) scale(var(--s));will-change:transform,opacity}
.btn.evade-enabled{transition:transform var(--mid) var(--ease-soft), opacity var(--micro)}
.btn:focus{outline:2px solid rgba(255,127,191,0.25);outline-offset:4px}
.btn:hover{transform:translate(var(--tx), var(--ty)) scale(calc(var(--s) + 0.03));box-shadow:var(--shadow-lg)}
.btn:active{transform:translate(var(--tx), var(--ty)) scale(calc(var(--s) - 0.04))}

.btn-yes{background:linear-gradient(180deg,#ffdff0,#ffd1e6);color:#5b2430}
.btn-no{background:linear-gradient(180deg,#ffe7ec,#ffd0d8);color:#60202a;opacity:1}

/* Hidden state used when we need instant removal */
.hidden{display:none}

/* Smooth entrance/exit helpers */
.fade-up-enter{opacity:0;transform:translateY(10px)}
.fade-up-enter.fade-up-enter-to{opacity:1;transform:translateY(0);transition:opacity var(--mid) var(--ease-soft), transform var(--mid) var(--ease-soft)}
.fade-down-exit{opacity:1;transform:translateY(0)}
.fade-down-exit.fade-down-exit-to{opacity:0;transform:translateY(-8px);transition:opacity var(--mid) var(--ease-soft), transform var(--mid) var(--ease-soft)}

/* Response screen */
.response{position:relative;opacity:0;pointer-events:none;transform:translateY(8px)}
.response.is-visible{opacity:1;transform:translateY(0);pointer-events:auto;transition:opacity var(--mid) var(--ease-soft), transform var(--mid) var(--ease-soft)}
.response-content{min-height:60vh;align-items:center;justify-content:center;padding:30px}
.response-text{width:45%;min-width:260px;background:var(--card);padding:28px;border-radius:16px;box-shadow:var(--shadow-lg);font-size:18px;line-height:1.5;color:#3f2731}

/* Nav */
.nav{position:fixed;top:10px;left:0;right:0;height:64px;background:rgba(255,255,255,0.5);display:flex;align-items:flex-end;justify-content:center;pointer-events:none;transform:translateY(-100%);transition:transform var(--long) var(--ease-soft), background .25s}
.nav--visible{transform:translateY(0);pointer-events:auto;backdrop-filter: blur(6px);box-shadow:0 6px 26px rgba(40,18,30,0.06)}
.nav-inner{width:100%;max-width:960px;padding:12px;display:flex;justify-content:flex-end}
.nav-item{background:rgba(255,255,255,0.86);border-radius:999px;padding:10px 16px;border:none;cursor:pointer;box-shadow:var(--shadow-sm);font-weight:600}

/* Gift area - heart box container */
.gift-area{display:flex;align-items:center;justify-content:center;margin-top:20px}
.gift-box{width:180px;height:150px;background:linear-gradient(180deg,var(--accent-2),var(--accent));border-radius:12px;position:relative;display:flex;align-items:center;justify-content:center;cursor:pointer;box-shadow:0 22px 48px rgba(255,110,150,0.12);transform-origin:center;transition:transform var(--mid) var(--ease-soft), box-shadow var(--mid)}
.gift-box:hover{transform:translateY(-6px) scale(1.02)}
.gift-lid{position:absolute;top:-22px;left:6px;right:6px;height:46px;background:linear-gradient(180deg,var(--accent),#ff5f9f);border-radius:10px 10px 6px 6px;transition:transform var(--long) var(--ease-soft), opacity var(--long)}
.gift-ribbon{position:absolute;left:50%;top:36px;width:18px;height:82px;background:#fff;border-radius:8px;transform:translateX(-50%)}
.gift-unwrapped .gift-lid{transform:translateY(-140%) rotate(-12deg);opacity:0}
.gift-unwrapped .gift-box{transform:translateY(10px)}

/* ===== FLIP CARD STYLES ===== */

/* Flip card container with perspective for 3D effect */
.flip-card-wrapper{
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  perspective:1000px;
  width:100%;
  height:40vh;
  max-width:500px;
  margin:0 auto;
  overflow: visible;
}

.flip-card{
  position:relative;
  width:100%;
  height:100%;
  cursor:pointer;
  transform-style:preserve-3d;
  transition:transform 0.7s cubic-bezier(0.68, -0.55, 0.265, 1.55);
  background:transparent;
  border:none;
  padding:0;
  margin:0;
}

.flip-card.flipped{
  transform:rotateY(180deg);
}

/* Card sides */
.flip-card-side{
  position:absolute;
  width:100%;
  height:100%;
  backface-visibility:hidden;
  -webkit-backface-visibility:hidden;
  display:flex;
  align-items:center;
  justify-content:center;
  overflow:hidden;
}

.flip-card-front{
  background:linear-gradient(135deg, #fffaf6 0%, #fff6f1 100%);
  padding:20px;
  text-align:center;
  border-radius:12px;
  box-shadow:0 12px 40px rgba(78,24,48,0.1), inset 0 0 0 1px rgba(0,0,0,0.03);
  z-index:2;
}

.flip-card-back{
  background:linear-gradient(135deg, #ffdfe8 0%, #ffc4d6 100%);
  padding:20px;
  text-align:center;
  border-radius:12px;
  box-shadow:0 12px 40px rgba(78,24,48,0.1), inset 0 0 0 1px rgba(0,0,0,0.03);
  transform:rotateY(180deg);
  z-index:1;
  overflow-y: auto;
}

.flip-card-back .flip-card-content{
  justify-content: flex-start;
}

.flip-card-back .flip-card-content.centered{
  justify-content: center;
}

/* Card content styling */
.flip-card-content{
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  gap:8px;
  width:100%;
  height:100%;
}

.flip-card-content h2{
  font-family:'Playfair Display', serif;
  font-size:20px;
  margin:0;
  color:var(--text);
  font-weight:600;
}

.flip-card-content p{
  font-size:12px;
  line-height:1.3;
  color:#5a3a4a;
  margin:0;
  max-width:35ch;
}

/* Image placeholder for back side */
.flip-card-image{
  width:140px;
  height:120px;
  background:rgba(255,255,255,0.6);
  border-radius:8px;
  display:flex;
  align-items:center;
  justify-content:center;
  flex-direction:column;
  gap:8px;
}

.flip-card-image svg{
  width:60px;
  height:60px;
  opacity:0.3;
}

.flip-card-image p{
  font-size:12px;
  color:#8a5f6f;
  margin:0;
}

/* Navigation hint below card */
.flip-card-hint{
  margin-top:24px;
  font-size:13px;
  color:rgba(74,43,58,0.6);
  text-align:center;
  transition:opacity 0.3s ease;
}

.flip-card-hint.hidden{
  opacity:0;
  pointer-events:none;
}

/* Page indicator */
.page-indicator{
  font-size:12px;
  color:rgba(74,43,58,0.5);
  margin-top:12px;
  transition:opacity 0.3s ease;
}

/* Entrance animation for card */
.flip-card-wrapper.entering .flip-card{
  animation:cardEnter 0.6s cubic-bezier(0.22,0.9,0.29,1);
}

@keyframes cardEnter{
  from{
    opacity:0;
    transform:translateY(10px) scale(0.98);
  }
  to{
    opacity:1;
    transform:translateY(0) scale(1);
  }
}

/* Exit animation before page change */
.flip-card.exiting{
  animation:cardExit 0.4s ease-out forwards;
}

@keyframes cardExit{
  from{
    opacity:1;
    transform:rotateY(0deg) scale(1);
  }
  to{
    opacity:0;
    transform:rotateY(-90deg) scale(0.9);
  }
}

/* Heart shape for gift opening */
.heart-box{width:220px;height:200px;display:flex;align-items:center;justify-content:center}
.heart-shape{position:relative;width:120px;height:110px;background:transparent;transition:transform var(--mid) var(--ease-soft), opacity var(--mid)}
.heart-shape:before,.heart-shape:after{content:'';position:absolute;width:60px;height:60px;background:linear-gradient(180deg,var(--accent),var(--accent-2));border-radius:50%;box-shadow:0 10px 30px rgba(255,100,150,0.12)}
.heart-shape:before{left:20%;top:6%}
.heart-shape:after{right:20%;top:6%}
.heart-shape .heart-bottom{position:absolute;left:50%;top:36%;width:100px;height:100px;background:linear-gradient(180deg,var(--accent),#ff5f9f);transform:translateX(-50%) rotate(45deg);border-radius:18px 18px 22px 22px}
.heart-box.opening .heart-shape{transform:scale(0.98) rotate(-6deg)}
.heart-box.opened{opacity:0;transform:scale(0.92) translateY(-10px);transition:opacity var(--mid) var(--ease-soft), transform var(--mid) var(--ease-soft)}

/* Button microinteractions - subtle spring on press */
.btn{transition:transform var(--micro) var(--ease-soft), box-shadow var(--micro) var(--ease-soft), opacity var(--micro)}
.btn:active{transition:transform 180ms cubic-bezier(.2,.8,.3,1)}
.btn:focus{box-shadow:0 8px 28px rgba(80,20,40,0.08)}

/* Reduced motion */
@media (prefers-reduced-motion: reduce){
  :root{ --micro: 1ms; --mid: 1ms; --long: 1ms }
  *{animation-duration:0.001ms!important;transition-duration:0.001ms!important}
}

@media (max-width:720px){
  .response-text{width:88%}
  .gif-placeholder.large{width:170px;height:170px}
  .question{font-size:28px}
  .btn{padding:10px 18px}
  
  .flip-card-front, .flip-card-back{
    padding:32px;
  }
  
  .flip-card-content h2{
    font-size:24px;
  }
  
  .flip-card-content p{
    font-size:14px;
  }
}

/* Final No-button evasive mode */
.btn.final-evade{position:fixed;z-index:80;will-change:transform,left,top}
.chat-head{
  position:fixed;
  pointer-events:none;
  display:flex;align-items:center;justify-content:center;
  padding:8px 12px;font-size:13px;font-weight:600;color:#5b2430;
  background:linear-gradient(180deg,#ffdfe7,#ffd1dd);border-radius:999px;box-shadow:0 8px 20px rgba(80,20,40,0.08);
  transform-origin:center center;opacity:0;transition:transform 700ms var(--ease-soft), opacity 700ms var(--ease-soft);
}
.chat-head.small{padding:6px 10px;font-size:12px}

/* quick accent variants */
.chat-head.alt{background:linear-gradient(180deg,#ffe7ef,#ffd0d8)}
